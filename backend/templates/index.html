<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Smart Trip Planner – Multi-Agent Tourism</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- CSS: make sure file is at backend/static/css/style.css -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

</head>
<body>
<div class="app-wrapper">
    <div class="card">
        <h1 class="title">Smart Trip Planner</h1>
        <p class="subtitle">
            Ask me about any place in the world.<br />
            <span class="example">
                Example: I'm going to go to Mysuru, let's plan my trip.
            </span>
        </p>

        <form id="trip-form">
            <label for="user-input" class="label">Describe your plan or question:</label>
            <textarea
                id="user-input"
                rows="3"
                placeholder="I'm going to go to Bangalore, what is the temperature there?"
            ></textarea>
            <button type="submit" id="submit-btn">Ask Tourism Agent</button>
        </form>

        <div id="loader" class="loader hidden">
            Talking to weather &amp; places agents...
        </div>

        <div id="response" class="response hidden">
            <h2>Result</h2>
            <pre id="response-text"></pre>
        </div>

        <footer class="footer">
            Multi-Agent System • Geocoding (Nominatim) • Weather (Open-Meteo) • Places (Overpass / OSM)
        </footer>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("trip-form");
    const input = document.getElementById("user-input");
    const responseBox = document.getElementById("response");
    const responseText = document.getElementById("response-text");
    const loader = document.getElementById("loader");
    const submitBtn = document.getElementById("submit-btn");

    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const message = input.value.trim();
        if (!message) {
            alert("Please type something first.");
            return;
        }

        loader.classList.remove("hidden");
        responseBox.classList.add("hidden");
        submitBtn.disabled = true;
        submitBtn.textContent = "Thinking...";

        try {
            const res = await fetch("/api/query", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ message })
            });

            const data = await res.json();
            responseText.textContent = data.reply || "No response.";
            responseBox.classList.remove("hidden");
        } catch (err) {
            console.error(err);
            responseText.textContent = "Something went wrong. Please try again.";
            responseBox.classList.remove("hidden");
        } finally {
            loader.classList.add("hidden");
            submitBtn.disabled = false;
            submitBtn.textContent = "Ask Tourism Agent";
        }
    });
});
</script>
</body>
</html>
